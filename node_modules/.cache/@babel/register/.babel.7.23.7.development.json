{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"const express = require(\"express\");\nconst bodyParser = require(\"body-parser\");\nconst initWebRoutes = require(\"./route/web.js\");\nconst cors = require(\"cors\");\nconst mongoose = require(\"mongoose\");\nconst cookieParser = require(\"cookie-parser\");\nrequire(\"dotenv\").config();\nlet app = express();\napp.use(cors({\n  origin: \"http://localhost:5173\",\n  credentials: true\n}));\napp.use(cookieParser());\napp.use(bodyParser.json({\n  limit: \"50mb\"\n}));\napp.use(bodyParser.urlencoded({\n  limit: \"50mb\",\n  extended: true\n}));\ninitWebRoutes(app);\nlet port = process.env.PORT || 8080;\napp.listen(port, () => {\n  console.log(\"Backend Nodejs is running on port: \" + port);\n});\nmongoose.connect(\"mongodb+srv://netwrok:dellcomk@cluster0.utri14v.mongodb.net/?retryWrites=true&w=majority\", {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => console.log(\"Mongodb connect establish\")).catch(error => console.log(\"MongoDB connection failed\"));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJvZHlQYXJzZXIiLCJpbml0V2ViUm91dGVzIiwiY29ycyIsIm1vbmdvb3NlIiwiY29va2llUGFyc2VyIiwiY29uZmlnIiwiYXBwIiwidXNlIiwib3JpZ2luIiwiY3JlZGVudGlhbHMiLCJqc29uIiwibGltaXQiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJsaXN0ZW4iLCJjb25zb2xlIiwibG9nIiwiY29ubmVjdCIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsInRoZW4iLCJjYXRjaCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiJEOlxcSOG7jWMgaMOgbmggdOG7rSB04bq/XFxzb2NpYWwgbmV0d29ya1xcYmFja2VuZFxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKFwiYm9keS1wYXJzZXJcIik7XHJcbmNvbnN0IGluaXRXZWJSb3V0ZXMgPSByZXF1aXJlKFwiLi9yb3V0ZS93ZWIuanNcIik7XHJcbmNvbnN0IGNvcnMgPSByZXF1aXJlKFwiY29yc1wiKTtcclxuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XHJcbmNvbnN0IGNvb2tpZVBhcnNlciA9IHJlcXVpcmUoXCJjb29raWUtcGFyc2VyXCIpO1xyXG5cclxucmVxdWlyZShcImRvdGVudlwiKS5jb25maWcoKTtcclxuXHJcbmxldCBhcHAgPSBleHByZXNzKCk7XHJcbmFwcC51c2UoY29ycyh7IG9yaWdpbjogXCJodHRwOi8vbG9jYWxob3N0OjUxNzNcIiwgY3JlZGVudGlhbHM6IHRydWUgfSkpO1xyXG5cclxuYXBwLnVzZShjb29raWVQYXJzZXIoKSk7XHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKHsgbGltaXQ6IFwiNTBtYlwiIH0pKTtcclxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBsaW1pdDogXCI1MG1iXCIsIGV4dGVuZGVkOiB0cnVlIH0pKTtcclxuXHJcbmluaXRXZWJSb3V0ZXMoYXBwKTtcclxuXHJcbmxldCBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCA4MDgwO1xyXG5hcHAubGlzdGVuKHBvcnQsICgpID0+IHtcclxuICBjb25zb2xlLmxvZyhcIkJhY2tlbmQgTm9kZWpzIGlzIHJ1bm5pbmcgb24gcG9ydDogXCIgKyBwb3J0KTtcclxufSk7XHJcblxyXG5tb25nb29zZVxyXG4gIC5jb25uZWN0KFxyXG4gICAgXCJtb25nb2RiK3NydjovL25ldHdyb2s6ZGVsbGNvbWtAY2x1c3RlcjAudXRyaTE0di5tb25nb2RiLm5ldC8/cmV0cnlXcml0ZXM9dHJ1ZSZ3PW1ham9yaXR5XCIsXHJcbiAgICB7XHJcbiAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcclxuICAgICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxyXG4gICAgfVxyXG4gIClcclxuICAudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIk1vbmdvZGIgY29ubmVjdCBlc3RhYmxpc2hcIikpXHJcbiAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coXCJNb25nb0RCIGNvbm5lY3Rpb24gZmFpbGVkXCIpKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsYUFBYSxDQUFDO0FBQ3pDLE1BQU1FLGFBQWEsR0FBR0YsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQy9DLE1BQU1HLElBQUksR0FBR0gsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUM1QixNQUFNSSxRQUFRLEdBQUdKLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDcEMsTUFBTUssWUFBWSxHQUFHTCxPQUFPLENBQUMsZUFBZSxDQUFDO0FBRTdDQSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUNNLE1BQU0sQ0FBQyxDQUFDO0FBRTFCLElBQUlDLEdBQUcsR0FBR1IsT0FBTyxDQUFDLENBQUM7QUFDbkJRLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDTCxJQUFJLENBQUM7RUFBRU0sTUFBTSxFQUFFLHVCQUF1QjtFQUFFQyxXQUFXLEVBQUU7QUFBSyxDQUFDLENBQUMsQ0FBQztBQUVyRUgsR0FBRyxDQUFDQyxHQUFHLENBQUNILFlBQVksQ0FBQyxDQUFDLENBQUM7QUFDdkJFLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDUCxVQUFVLENBQUNVLElBQUksQ0FBQztFQUFFQyxLQUFLLEVBQUU7QUFBTyxDQUFDLENBQUMsQ0FBQztBQUMzQ0wsR0FBRyxDQUFDQyxHQUFHLENBQUNQLFVBQVUsQ0FBQ1ksVUFBVSxDQUFDO0VBQUVELEtBQUssRUFBRSxNQUFNO0VBQUVFLFFBQVEsRUFBRTtBQUFLLENBQUMsQ0FBQyxDQUFDO0FBRWpFWixhQUFhLENBQUNLLEdBQUcsQ0FBQztBQUVsQixJQUFJUSxJQUFJLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxJQUFJLElBQUksSUFBSTtBQUNuQ1gsR0FBRyxDQUFDWSxNQUFNLENBQUNKLElBQUksRUFBRSxNQUFNO0VBQ3JCSyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxxQ0FBcUMsR0FBR04sSUFBSSxDQUFDO0FBQzNELENBQUMsQ0FBQztBQUVGWCxRQUFRLENBQ0xrQixPQUFPLENBQ04sMEZBQTBGLEVBQzFGO0VBQ0VDLGVBQWUsRUFBRSxJQUFJO0VBQ3JCQyxrQkFBa0IsRUFBRTtBQUN0QixDQUNGLENBQUMsQ0FDQUMsSUFBSSxDQUFDLE1BQU1MLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDJCQUEyQixDQUFDLENBQUMsQ0FDcERLLEtBQUssQ0FBRUMsS0FBSyxJQUFLUCxPQUFPLENBQUNDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDIn0=","map":{"version":3,"names":["express","require","bodyParser","initWebRoutes","cors","mongoose","cookieParser","config","app","use","origin","credentials","json","limit","urlencoded","extended","port","process","env","PORT","listen","console","log","connect","useNewUrlParser","useUnifiedTopology","then","catch","error"],"sourceRoot":"D:\\Học hành tử tế\\social network\\backend\\src\\","sources":["server.js"],"sourcesContent":["const express = require(\"express\");\r\nconst bodyParser = require(\"body-parser\");\r\nconst initWebRoutes = require(\"./route/web.js\");\r\nconst cors = require(\"cors\");\r\nconst mongoose = require(\"mongoose\");\r\nconst cookieParser = require(\"cookie-parser\");\r\n\r\nrequire(\"dotenv\").config();\r\n\r\nlet app = express();\r\napp.use(cors({ origin: \"http://localhost:5173\", credentials: true }));\r\n\r\napp.use(cookieParser());\r\napp.use(bodyParser.json({ limit: \"50mb\" }));\r\napp.use(bodyParser.urlencoded({ limit: \"50mb\", extended: true }));\r\n\r\ninitWebRoutes(app);\r\n\r\nlet port = process.env.PORT || 8080;\r\napp.listen(port, () => {\r\n  console.log(\"Backend Nodejs is running on port: \" + port);\r\n});\r\n\r\nmongoose\r\n  .connect(\r\n    \"mongodb+srv://netwrok:dellcomk@cluster0.utri14v.mongodb.net/?retryWrites=true&w=majority\",\r\n    {\r\n      useNewUrlParser: true,\r\n      useUnifiedTopology: true,\r\n    }\r\n  )\r\n  .then(() => console.log(\"Mongodb connect establish\"))\r\n  .catch((error) => console.log(\"MongoDB connection failed\"));\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,UAAU,GAAGD,OAAO,CAAC,aAAa,CAAC;AACzC,MAAME,aAAa,GAAGF,OAAO,CAAC,gBAAgB,CAAC;AAC/C,MAAMG,IAAI,GAAGH,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMI,QAAQ,GAAGJ,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMK,YAAY,GAAGL,OAAO,CAAC,eAAe,CAAC;AAE7CA,OAAO,CAAC,QAAQ,CAAC,CAACM,MAAM,CAAC,CAAC;AAE1B,IAAIC,GAAG,GAAGR,OAAO,CAAC,CAAC;AACnBQ,GAAG,CAACC,GAAG,CAACL,IAAI,CAAC;EAAEM,MAAM,EAAE,uBAAuB;EAAEC,WAAW,EAAE;AAAK,CAAC,CAAC,CAAC;AAErEH,GAAG,CAACC,GAAG,CAACH,YAAY,CAAC,CAAC,CAAC;AACvBE,GAAG,CAACC,GAAG,CAACP,UAAU,CAACU,IAAI,CAAC;EAAEC,KAAK,EAAE;AAAO,CAAC,CAAC,CAAC;AAC3CL,GAAG,CAACC,GAAG,CAACP,UAAU,CAACY,UAAU,CAAC;EAAED,KAAK,EAAE,MAAM;EAAEE,QAAQ,EAAE;AAAK,CAAC,CAAC,CAAC;AAEjEZ,aAAa,CAACK,GAAG,CAAC;AAElB,IAAIQ,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,IAAI,IAAI,IAAI;AACnCX,GAAG,CAACY,MAAM,CAACJ,IAAI,EAAE,MAAM;EACrBK,OAAO,CAACC,GAAG,CAAC,qCAAqC,GAAGN,IAAI,CAAC;AAC3D,CAAC,CAAC;AAEFX,QAAQ,CACLkB,OAAO,CACN,0FAA0F,EAC1F;EACEC,eAAe,EAAE,IAAI;EACrBC,kBAAkB,EAAE;AACtB,CACF,CAAC,CACAC,IAAI,CAAC,MAAML,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CAAC,CACpDK,KAAK,CAAEC,KAAK,IAAKP,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CAAC"}},"mtime":1706005680410},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\\\\src\\\\route\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\\\\src\\\\route\\\\web.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"const express = require(\"express\");\nconst bcrypt = require(\"bcrypt\");\nconst User = require(\"../controllers/User\");\nconst router = express.Router();\nconst jwt = require(\"jsonwebtoken\");\nconst jwtSecret = \"90204520430234\";\nlet initWebRoutes = app => {\n  router.post(\"/register\", async (req, res) => {\n    const {\n      name,\n      email,\n      password\n    } = req.body;\n    try {\n      const salt = await bcrypt.genSalt(12);\n      const hashedPassword = await bcrypt.hash(password, salt);\n      const userDoc = await User.create({\n        name,\n        email,\n        password: hashedPassword\n      });\n      res.json(userDoc);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json({\n        error: \"Internal server error\"\n      });\n    }\n  });\n  router.post(\"login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    try {\n      const userdoc = await User.findOne({\n        email\n      });\n      if (userdoc) {\n        const passwordOk = await bcrypt.compare(userdoc.password, password);\n        if (passwordOk) {\n          jwt.sign({\n            email: userdoc.email,\n            id: userdoc._id,\n            name: userdoc.name\n          }, jwtSecret, {}, (err, token) => {\n            if (err) throw err;\n            console.log(\"check userdoc\", userdoc);\n            res.cookie(\"token\", token).status(200).json(userdoc);\n          });\n        } else {\n          res.status(401).json({\n            err: \"Incorrect password\"\n          });\n        }\n      } else {\n        res.status(404).json({\n          err: \"User not found\"\n        });\n      }\n    } catch (e) {\n      console.log(e);\n      res.status(500).json({\n        err: \"Interial sever error\"\n      });\n    }\n  });\n  router.get(\"/profile\", (req, res) => {\n    const {\n      token\n    } = req.cookies;\n    if (token) {\n      jwt.verify(token, jwtSecret, {}, async (err, user) => {\n        const {\n          name,\n          email,\n          _id\n        } = await User.findById(user.id);\n        res.status(200).json({\n          name,\n          email,\n          _id\n        });\n      });\n    } else {\n      res.status(500).json(null);\n    }\n  });\n  router.get(\"/logout\", (req, res) => {\n    res.cookie(\"token\", \"\").json(true);\n  });\n  return app.use(\"/\", router);\n};\nmodule.exports = initWebRoutes;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJjcnlwdCIsIlVzZXIiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJqd3QiLCJqd3RTZWNyZXQiLCJpbml0V2ViUm91dGVzIiwiYXBwIiwicG9zdCIsInJlcSIsInJlcyIsIm5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiYm9keSIsInNhbHQiLCJnZW5TYWx0IiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwidXNlckRvYyIsImNyZWF0ZSIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiLCJ1c2VyZG9jIiwiZmluZE9uZSIsInBhc3N3b3JkT2siLCJjb21wYXJlIiwic2lnbiIsImlkIiwiX2lkIiwiZXJyIiwidG9rZW4iLCJsb2ciLCJjb29raWUiLCJlIiwiZ2V0IiwiY29va2llcyIsInZlcmlmeSIsInVzZXIiLCJmaW5kQnlJZCIsInVzZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkQ6XFxI4buNYyBow6BuaCB04butIHThur9cXHNvY2lhbCBuZXR3b3JrXFxiYWNrZW5kXFxzcmNcXHJvdXRlXFwiLCJzb3VyY2VzIjpbIndlYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoXCJiY3J5cHRcIik7XHJcbmNvbnN0IFVzZXIgPSByZXF1aXJlKFwiLi4vY29udHJvbGxlcnMvVXNlclwiKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcclxuY29uc3Qgand0U2VjcmV0ID0gXCI5MDIwNDUyMDQzMDIzNFwiO1xyXG5cclxubGV0IGluaXRXZWJSb3V0ZXMgPSAoYXBwKSA9PiB7XHJcbiAgcm91dGVyLnBvc3QoXCIvcmVnaXN0ZXJcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoMTIpO1xyXG4gICAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0KTtcclxuXHJcbiAgICAgIGNvbnN0IHVzZXJEb2MgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBlbWFpbCxcclxuICAgICAgICBwYXNzd29yZDogaGFzaGVkUGFzc3dvcmQsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVzLmpzb24odXNlckRvYyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogXCJJbnRlcm5hbCBzZXJ2ZXIgZXJyb3JcIiB9KTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcm91dGVyLnBvc3QoXCJsb2dpblwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVzZXJkb2MgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBlbWFpbCB9KTtcclxuICAgICAgaWYgKHVzZXJkb2MpIHtcclxuICAgICAgICBjb25zdCBwYXNzd29yZE9rID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUodXNlcmRvYy5wYXNzd29yZCwgcGFzc3dvcmQpO1xyXG4gICAgICAgIGlmIChwYXNzd29yZE9rKSB7XHJcbiAgICAgICAgICBqd3Quc2lnbihcclxuICAgICAgICAgICAgeyBlbWFpbDogdXNlcmRvYy5lbWFpbCwgaWQ6IHVzZXJkb2MuX2lkLCBuYW1lOiB1c2VyZG9jLm5hbWUgfSxcclxuICAgICAgICAgICAgand0U2VjcmV0LFxyXG4gICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgKGVyciwgdG9rZW4pID0+IHtcclxuICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjaGVjayB1c2VyZG9jXCIsIHVzZXJkb2MpO1xyXG4gICAgICAgICAgICAgIHJlcy5jb29raWUoXCJ0b2tlblwiLCB0b2tlbikuc3RhdHVzKDIwMCkuanNvbih1c2VyZG9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnI6IFwiSW5jb3JyZWN0IHBhc3N3b3JkXCIgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyOiBcIlVzZXIgbm90IGZvdW5kXCIgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyOiBcIkludGVyaWFsIHNldmVyIGVycm9yXCIgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHJvdXRlci5nZXQoXCIvcHJvZmlsZVwiLCAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IHsgdG9rZW4gfSA9IHJlcS5jb29raWVzO1xyXG4gICAgaWYgKHRva2VuKSB7XHJcbiAgICAgIGp3dC52ZXJpZnkodG9rZW4sIGp3dFNlY3JldCwge30sIGFzeW5jIChlcnIsIHVzZXIpID0+IHtcclxuICAgICAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBfaWQgfSA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodXNlci5pZCk7XHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBuYW1lLCBlbWFpbCwgX2lkIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKG51bGwpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICByb3V0ZXIuZ2V0KFwiL2xvZ291dFwiLCAocmVxLCByZXMpID0+IHtcclxuICAgIHJlcy5jb29raWUoXCJ0b2tlblwiLCBcIlwiKS5qc29uKHRydWUpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gYXBwLnVzZShcIi9cIiwgcm91dGVyKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaW5pdFdlYlJvdXRlcztcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1FLElBQUksR0FBR0YsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBQzNDLE1BQU1HLE1BQU0sR0FBR0osT0FBTyxDQUFDSyxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNQyxHQUFHLEdBQUdMLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDbkMsTUFBTU0sU0FBUyxHQUFHLGdCQUFnQjtBQUVsQyxJQUFJQyxhQUFhLEdBQUlDLEdBQUcsSUFBSztFQUMzQkwsTUFBTSxDQUFDTSxJQUFJLENBQUMsV0FBVyxFQUFFLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQzNDLE1BQU07TUFBRUMsSUFBSTtNQUFFQyxLQUFLO01BQUVDO0lBQVMsQ0FBQyxHQUFHSixHQUFHLENBQUNLLElBQUk7SUFDMUMsSUFBSTtNQUNGLE1BQU1DLElBQUksR0FBRyxNQUFNZixNQUFNLENBQUNnQixPQUFPLENBQUMsRUFBRSxDQUFDO01BQ3JDLE1BQU1DLGNBQWMsR0FBRyxNQUFNakIsTUFBTSxDQUFDa0IsSUFBSSxDQUFDTCxRQUFRLEVBQUVFLElBQUksQ0FBQztNQUV4RCxNQUFNSSxPQUFPLEdBQUcsTUFBTWxCLElBQUksQ0FBQ21CLE1BQU0sQ0FBQztRQUNoQ1QsSUFBSTtRQUNKQyxLQUFL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","map":{"version":3,"names":["express","require","bcrypt","User","router","Router","jwt","jwtSecret","initWebRoutes","app","post","req","res","name","email","password","body","salt","genSalt","hashedPassword","hash","userDoc","create","json","error","console","status","userdoc","findOne","passwordOk","compare","sign","id","_id","err","token","log","cookie","e","get","cookies","verify","user","findById","use","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\social network\\backend\\src\\route\\","sources":["web.js"],"sourcesContent":["const express = require(\"express\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst User = require(\"../controllers/User\");\r\nconst router = express.Router();\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst jwtSecret = \"90204520430234\";\r\n\r\nlet initWebRoutes = (app) => {\r\n  router.post(\"/register\", async (req, res) => {\r\n    const { name, email, password } = req.body;\r\n    try {\r\n      const salt = await bcrypt.genSalt(12);\r\n      const hashedPassword = await bcrypt.hash(password, salt);\r\n\r\n      const userDoc = await User.create({\r\n        name,\r\n        email,\r\n        password: hashedPassword,\r\n      });\r\n\r\n      res.json(userDoc);\r\n    } catch (error) {\r\n      console.error(error);\r\n      res.status(500).json({ error: \"Internal server error\" });\r\n    }\r\n  });\r\n\r\n  router.post(\"login\", async (req, res) => {\r\n    const { email, password } = req.body;\r\n    try {\r\n      const userdoc = await User.findOne({ email });\r\n      if (userdoc) {\r\n        const passwordOk = await bcrypt.compare(userdoc.password, password);\r\n        if (passwordOk) {\r\n          jwt.sign(\r\n            { email: userdoc.email, id: userdoc._id, name: userdoc.name },\r\n            jwtSecret,\r\n            {},\r\n            (err, token) => {\r\n              if (err) throw err;\r\n              console.log(\"check userdoc\", userdoc);\r\n              res.cookie(\"token\", token).status(200).json(userdoc);\r\n            }\r\n          );\r\n        } else {\r\n          res.status(401).json({ err: \"Incorrect password\" });\r\n        }\r\n      } else {\r\n        res.status(404).json({ err: \"User not found\" });\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n      res.status(500).json({ err: \"Interial sever error\" });\r\n    }\r\n  });\r\n\r\n  router.get(\"/profile\", (req, res) => {\r\n    const { token } = req.cookies;\r\n    if (token) {\r\n      jwt.verify(token, jwtSecret, {}, async (err, user) => {\r\n        const { name, email, _id } = await User.findById(user.id);\r\n        res.status(200).json({ name, email, _id });\r\n      });\r\n    } else {\r\n      res.status(500).json(null);\r\n    }\r\n  });\r\n\r\n  router.get(\"/logout\", (req, res) => {\r\n    res.cookie(\"token\", \"\").json(true);\r\n  });\r\n\r\n  return app.use(\"/\", router);\r\n};\r\n\r\nmodule.exports = initWebRoutes;\r\n"],"mappings":"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"}},"mtime":1706001781375},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\\\\src\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\\\\src\\\\controllers\\\\User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\social network\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nconst {\n  Schema\n} = mongoose;\nconst UserSchema = new Schema({\n  name: String,\n  email: {\n    type: String,\n    unique: true\n  },\n  password: String\n});\nconst UserModel = mongoose.model(\"User\", UserSchema);\nmodule.exports = UserModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwibmFtZSIsIlN0cmluZyIsImVtYWlsIiwidHlwZSIsInVuaXF1ZSIsInBhc3N3b3JkIiwiVXNlck1vZGVsIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJEOlxcSOG7jWMgaMOgbmggdOG7rSB04bq/XFxzb2NpYWwgbmV0d29ya1xcYmFja2VuZFxcc3JjXFxjb250cm9sbGVyc1xcIiwic291cmNlcyI6WyJVc2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xyXG5jb25zdCB7IFNjaGVtYSB9ID0gbW9uZ29vc2U7XHJcblxyXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XHJcbiAgbmFtZTogU3RyaW5nLFxyXG4gIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgdW5pcXVlOiB0cnVlIH0sXHJcbiAgcGFzc3dvcmQ6IFN0cmluZyxcclxufSk7XHJcblxyXG5jb25zdCBVc2VyTW9kZWwgPSBtb25nb29zZS5tb2RlbChcIlVzZXJcIiwgVXNlclNjaGVtYSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFVzZXJNb2RlbDtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDcEMsTUFBTTtFQUFFQztBQUFPLENBQUMsR0FBR0YsUUFBUTtBQUUzQixNQUFNRyxVQUFVLEdBQUcsSUFBSUQsTUFBTSxDQUFDO0VBQzVCRSxJQUFJLEVBQUVDLE1BQU07RUFDWkMsS0FBSyxFQUFFO0lBQUVDLElBQUksRUFBRUYsTUFBTTtJQUFFRyxNQUFNLEVBQUU7RUFBSyxDQUFDO0VBQ3JDQyxRQUFRLEVBQUVKO0FBQ1osQ0FBQyxDQUFDO0FBRUYsTUFBTUssU0FBUyxHQUFHVixRQUFRLENBQUNXLEtBQUssQ0FBQyxNQUFNLEVBQUVSLFVBQVUsQ0FBQztBQUVwRFMsTUFBTSxDQUFDQyxPQUFPLEdBQUdILFNBQVMifQ==","map":{"version":3,"names":["mongoose","require","Schema","UserSchema","name","String","email","type","unique","password","UserModel","model","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\social network\\backend\\src\\controllers\\","sources":["User.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\r\nconst { Schema } = mongoose;\r\n\r\nconst UserSchema = new Schema({\r\n  name: String,\r\n  email: { type: String, unique: true },\r\n  password: String,\r\n});\r\n\r\nconst UserModel = mongoose.model(\"User\", UserSchema);\r\n\r\nmodule.exports = UserModel;\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAM;EAAEC;AAAO,CAAC,GAAGF,QAAQ;AAE3B,MAAMG,UAAU,GAAG,IAAID,MAAM,CAAC;EAC5BE,IAAI,EAAEC,MAAM;EACZC,KAAK,EAAE;IAAEC,IAAI,EAAEF,MAAM;IAAEG,MAAM,EAAE;EAAK,CAAC;EACrCC,QAAQ,EAAEJ;AACZ,CAAC,CAAC;AAEF,MAAMK,SAAS,GAAGV,QAAQ,CAACW,KAAK,CAAC,MAAM,EAAER,UAAU,CAAC;AAEpDS,MAAM,CAACC,OAAO,GAAGH,SAAS"}},"mtime":1706001645862},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"const express = require(\"express\");\nconst cors = require(\"cors\");\nconst cookieParser = require(\"cookie-parser\");\nconst {\n  default: helmet\n} = require(\"helmet\");\nconst compression = require(\"compression\");\nrequire(\"dotenv\").config();\nlet app = express();\napp.use(cors({\n  origin: \"http://localhost:5173\",\n  credentials: true\n}));\napp.use(cookieParser());\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: true\n}));\napp.use(helmet());\napp.use(compression());\nrequire(\"./db/init.db\");\napp.use(\"\", require(\"./routes/index\"));\napp.listen(8000, () => {\n  console.log(\"Server is running in port 8000\");\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImNvcnMiLCJjb29raWVQYXJzZXIiLCJkZWZhdWx0IiwiaGVsbWV0IiwiY29tcHJlc3Npb24iLCJjb25maWciLCJhcHAiLCJ1c2UiLCJvcmlnaW4iLCJjcmVkZW50aWFscyIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJsaXN0ZW4iLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiJEOlxcSOG7jWMgaMOgbmggdOG7rSB04bq/XFxGYWNlYm9va1xcYmFja2VuZFxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IGNvcnMgPSByZXF1aXJlKFwiY29yc1wiKTtcclxuY29uc3QgY29va2llUGFyc2VyID0gcmVxdWlyZShcImNvb2tpZS1wYXJzZXJcIik7XHJcbmNvbnN0IHsgZGVmYXVsdDogaGVsbWV0IH0gPSByZXF1aXJlKFwiaGVsbWV0XCIpO1xyXG5jb25zdCBjb21wcmVzc2lvbiA9IHJlcXVpcmUoXCJjb21wcmVzc2lvblwiKTtcclxucmVxdWlyZShcImRvdGVudlwiKS5jb25maWcoKTtcclxuXHJcbmxldCBhcHAgPSBleHByZXNzKCk7XHJcbmFwcC51c2UoY29ycyh7IG9yaWdpbjogXCJodHRwOi8vbG9jYWxob3N0OjUxNzNcIiwgY3JlZGVudGlhbHM6IHRydWUgfSkpO1xyXG5hcHAudXNlKGNvb2tpZVBhcnNlcigpKTtcclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xyXG5hcHAudXNlKGhlbG1ldCgpKTsgIFxyXG5hcHAudXNlKGNvbXByZXNzaW9uKCkpO1xyXG5yZXF1aXJlKFwiLi9kYi9pbml0LmRiXCIpO1xyXG5hcHAudXNlKFwiXCIsIHJlcXVpcmUoXCIuL3JvdXRlcy9pbmRleFwiKSk7XHJcbmFwcC5saXN0ZW4oODAwMCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKFwiU2VydmVyIGlzIHJ1bm5pbmcgaW4gcG9ydCA4MDAwXCIpO1xyXG59KTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLE1BQU1FLFlBQVksR0FBR0YsT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUM3QyxNQUFNO0VBQUVHLE9BQU8sRUFBRUM7QUFBTyxDQUFDLEdBQUdKLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDN0MsTUFBTUssV0FBVyxHQUFHTCxPQUFPLENBQUMsYUFBYSxDQUFDO0FBQzFDQSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUNNLE1BQU0sQ0FBQyxDQUFDO0FBRTFCLElBQUlDLEdBQUcsR0FBR1IsT0FBTyxDQUFDLENBQUM7QUFDbkJRLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDUCxJQUFJLENBQUM7RUFBRVEsTUFBTSxFQUFFLHVCQUF1QjtFQUFFQyxXQUFXLEVBQUU7QUFBSyxDQUFDLENBQUMsQ0FBQztBQUNyRUgsR0FBRyxDQUFDQyxHQUFHLENBQUNOLFlBQVksQ0FBQyxDQUFDLENBQUM7QUFDdkJLLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDVCxPQUFPLENBQUNZLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDdkJKLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDVCxPQUFPLENBQUNhLFVBQVUsQ0FBQztFQUFFQyxRQUFRLEVBQUU7QUFBSyxDQUFDLENBQUMsQ0FBQztBQUMvQ04sR0FBRyxDQUFDQyxHQUFHLENBQUNKLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDakJHLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDSCxXQUFXLENBQUMsQ0FBQyxDQUFDO0FBQ3RCTCxPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ3ZCTyxHQUFHLENBQUNDLEdBQUcsQ0FBQyxFQUFFLEVBQUVSLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ3RDTyxHQUFHLENBQUNPLE1BQU0sQ0FBQyxJQUFJLEVBQUUsTUFBTTtFQUNyQkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsZ0NBQWdDLENBQUM7QUFDL0MsQ0FBQyxDQUFDIn0=","map":{"version":3,"names":["express","require","cors","cookieParser","default","helmet","compression","config","app","use","origin","credentials","json","urlencoded","extended","listen","console","log"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\","sources":["server.js"],"sourcesContent":["const express = require(\"express\");\r\nconst cors = require(\"cors\");\r\nconst cookieParser = require(\"cookie-parser\");\r\nconst { default: helmet } = require(\"helmet\");\r\nconst compression = require(\"compression\");\r\nrequire(\"dotenv\").config();\r\n\r\nlet app = express();\r\napp.use(cors({ origin: \"http://localhost:5173\", credentials: true }));\r\napp.use(cookieParser());\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\napp.use(helmet());  \r\napp.use(compression());\r\nrequire(\"./db/init.db\");\r\napp.use(\"\", require(\"./routes/index\"));\r\napp.listen(8000, () => {\r\n  console.log(\"Server is running in port 8000\");\r\n});\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAME,YAAY,GAAGF,OAAO,CAAC,eAAe,CAAC;AAC7C,MAAM;EAAEG,OAAO,EAAEC;AAAO,CAAC,GAAGJ,OAAO,CAAC,QAAQ,CAAC;AAC7C,MAAMK,WAAW,GAAGL,OAAO,CAAC,aAAa,CAAC;AAC1CA,OAAO,CAAC,QAAQ,CAAC,CAACM,MAAM,CAAC,CAAC;AAE1B,IAAIC,GAAG,GAAGR,OAAO,CAAC,CAAC;AACnBQ,GAAG,CAACC,GAAG,CAACP,IAAI,CAAC;EAAEQ,MAAM,EAAE,uBAAuB;EAAEC,WAAW,EAAE;AAAK,CAAC,CAAC,CAAC;AACrEH,GAAG,CAACC,GAAG,CAACN,YAAY,CAAC,CAAC,CAAC;AACvBK,GAAG,CAACC,GAAG,CAACT,OAAO,CAACY,IAAI,CAAC,CAAC,CAAC;AACvBJ,GAAG,CAACC,GAAG,CAACT,OAAO,CAACa,UAAU,CAAC;EAAEC,QAAQ,EAAE;AAAK,CAAC,CAAC,CAAC;AAC/CN,GAAG,CAACC,GAAG,CAACJ,MAAM,CAAC,CAAC,CAAC;AACjBG,GAAG,CAACC,GAAG,CAACH,WAAW,CAAC,CAAC,CAAC;AACtBL,OAAO,CAAC,cAAc,CAAC;AACvBO,GAAG,CAACC,GAAG,CAAC,EAAE,EAAER,OAAO,CAAC,gBAAgB,CAAC,CAAC;AACtCO,GAAG,CAACO,MAAM,CAAC,IAAI,EAAE,MAAM;EACrBC,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;AAC/C,CAAC,CAAC"}},"mtime":1714278454155},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\route\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\route\\\\web.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"const express = require(\"express\");\nconst bcrypt = require(\"bcrypt\");\nconst router = express.Router();\nconst jwt = require(\"jsonwebtoken\");\nconst jwtSecret = \"90204520430234\";\nlet initWebRoutes = app => {\n  router.post(\"/register\", async (req, res) => {\n    const {\n      name,\n      email,\n      password\n    } = req.body;\n    try {\n      const salt = await bcrypt.genSalt(12);\n      const hashedPassword = await bcrypt.hash(password, salt);\n      const userDoc = await User.create({\n        name,\n        email,\n        password: hashedPassword\n      });\n      res.json(userDoc);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json({\n        error: \"Internal server error\"\n      });\n    }\n  });\n  router.post(\"login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    try {\n      const userdoc = await User.findOne({\n        email\n      });\n      if (userdoc) {\n        const passwordOk = await bcrypt.compare(userdoc.password, password);\n        if (passwordOk) {\n          jwt.sign({\n            email: userdoc.email,\n            id: userdoc._id,\n            name: userdoc.name\n          }, jwtSecret, {}, (err, token) => {\n            if (err) throw err;\n            console.log(\"check userdoc\", userdoc);\n            res.cookie(\"token\", token).status(200).json(userdoc);\n          });\n        } else {\n          res.status(401).json({\n            err: \"Incorrect password\"\n          });\n        }\n      } else {\n        res.status(404).json({\n          err: \"User not found\"\n        });\n      }\n    } catch (e) {\n      console.log(e);\n      res.status(500).json({\n        err: \"Interial sever error\"\n      });\n    }\n  });\n  router.get(\"/profile\", (req, res) => {\n    const {\n      token\n    } = req.cookies;\n    if (token) {\n      jwt.verify(token, jwtSecret, {}, async (err, user) => {\n        const {\n          name,\n          email,\n          _id\n        } = await User.findById(user.id);\n        res.status(200).json({\n          name,\n          email,\n          _id\n        });\n      });\n    } else {\n      res.status(500).json(null);\n    }\n  });\n  router.get(\"/logout\", (req, res) => {\n    res.cookie(\"token\", \"\").json(true);\n  });\n  return app.use(\"/\", router);\n};\nmodule.exports = initWebRoutes;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJjcnlwdCIsInJvdXRlciIsIlJvdXRlciIsImp3dCIsImp3dFNlY3JldCIsImluaXRXZWJSb3V0ZXMiLCJhcHAiLCJwb3N0IiwicmVxIiwicmVzIiwibmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5Iiwic2FsdCIsImdlblNhbHQiLCJoYXNoZWRQYXNzd29yZCIsImhhc2giLCJ1c2VyRG9jIiwiVXNlciIsImNyZWF0ZSIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiLCJ1c2VyZG9jIiwiZmluZE9uZSIsInBhc3N3b3JkT2siLCJjb21wYXJlIiwic2lnbiIsImlkIiwiX2lkIiwiZXJyIiwidG9rZW4iLCJsb2ciLCJjb29raWUiLCJlIiwiZ2V0IiwiY29va2llcyIsInZlcmlmeSIsInVzZXIiLCJmaW5kQnlJZCIsInVzZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkQ6XFxI4buNYyBow6BuaCB04butIHThur9cXEZhY2Vib29rXFxiYWNrZW5kXFxzcmNcXHJvdXRlXFwiLCJzb3VyY2VzIjpbIndlYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoXCJiY3J5cHRcIik7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmNvbnN0IGp3dCA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XHJcbmNvbnN0IGp3dFNlY3JldCA9IFwiOTAyMDQ1MjA0MzAyMzRcIjtcclxuXHJcbmxldCBpbml0V2ViUm91dGVzID0gKGFwcCkgPT4ge1xyXG4gIHJvdXRlci5wb3N0KFwiL3JlZ2lzdGVyXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc3QgeyBuYW1lLCBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xyXG4gICAgdHJ5IHsgICBcclxuICAgICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEyKTtcclxuICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgc2FsdCk7XHJcblxyXG4gICAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlci5jcmVhdGUoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZW1haWwsXHJcbiAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlcy5qc29uKHVzZXJEb2MpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHJvdXRlci5wb3N0KFwibG9naW5cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1c2VyZG9jID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSk7XHJcbiAgICAgIGlmICh1c2VyZG9jKSB7XHJcbiAgICAgICAgY29uc3QgcGFzc3dvcmRPayA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHVzZXJkb2MucGFzc3dvcmQsIHBhc3N3b3JkKTtcclxuICAgICAgICBpZiAocGFzc3dvcmRPaykge1xyXG4gICAgICAgICAgand0LnNpZ24oXHJcbiAgICAgICAgICAgIHsgZW1haWw6IHVzZXJkb2MuZW1haWwsIGlkOiB1c2VyZG9jLl9pZCwgbmFtZTogdXNlcmRvYy5uYW1lIH0sXHJcbiAgICAgICAgICAgIGp3dFNlY3JldCxcclxuICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgIChlcnIsIHRva2VuKSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKGVycikgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2hlY2sgdXNlcmRvY1wiLCB1c2VyZG9jKTtcclxuICAgICAgICAgICAgICByZXMuY29va2llKFwidG9rZW5cIiwgdG9rZW4pLnN0YXR1cygyMDApLmpzb24odXNlcmRvYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyOiBcIkluY29ycmVjdCBwYXNzd29yZFwiIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycjogXCJVc2VyIG5vdCBmb3VuZFwiIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycjogXCJJbnRlcmlhbCBzZXZlciBlcnJvclwiIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICByb3V0ZXIuZ2V0KFwiL3Byb2ZpbGVcIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBjb25zdCB7IHRva2VuIH0gPSByZXEuY29va2llcztcclxuICAgIGlmICh0b2tlbikge1xyXG4gICAgICBqd3QudmVyaWZ5KHRva2VuLCBqd3RTZWNyZXQsIHt9LCBhc3luYyAoZXJyLCB1c2VyKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBuYW1lLCBlbWFpbCwgX2lkIH0gPSBhd2FpdCBVc2VyLmZpbmRCeUlkKHVzZXIuaWQpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbmFtZSwgZW1haWwsIF9pZCB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbihudWxsKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgcm91dGVyLmdldChcIi9sb2dvdXRcIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICByZXMuY29va2llKFwidG9rZW5cIiwgXCJcIikuanNvbih0cnVlKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGFwcC51c2UoXCIvXCIsIHJvdXRlcik7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGluaXRXZWJSb3V0ZXM7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxNQUFNRSxNQUFNLEdBQUdILE9BQU8sQ0FBQ0ksTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsR0FBRyxHQUFHSixPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ25DLE1BQU1LLFNBQVMsR0FBRyxnQkFBZ0I7QUFFbEMsSUFBSUMsYUFBYSxHQUFJQyxHQUFHLElBQUs7RUFDM0JMLE1BQU0sQ0FBQ00sSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUMzQyxNQUFNO01BQUVDLElBQUk7TUFBRUMsS0FBSztNQUFFQztJQUFTLENBQUMsR0FBR0osR0FBRyxDQUFDSyxJQUFJO0lBQzFDLElBQUk7TUFDRixNQUFNQyxJQUFJLEdBQUcsTUFBTWQsTUFBTSxDQUFDZSxPQUFPLENBQUMsRUFBRSxDQUFDO01BQ3JDLE1BQU1DLGNBQWMsR0FBRyxNQUFNaEIsTUFBTSxDQUFDaUIsSUFBSSxDQUFDTCxRQUFRLEVBQUVFLElBQUksQ0FBQztNQUV4RCxNQUFNSSxPQUFPLEdBQUcsTUFBTUMsSUFBSSxDQUFDQyxNQUFNLENBQUM7UUFDaENWLElBQUk7UUFDSkMsS0FBSztRQUNMQyxRQUFRLEVBQUVJO01BQ1osQ0FBQyxDQUFDO01BRUZQLEdBQUcsQ0FBQ1ksSUFBSSxDQUFDSCxPQUFPLENBQUM7SUFDbkIsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtNQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQ0EsS0FBSyxDQUFDO01BQ3BCYixHQUFHLENBQUNlLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0gsSUFBSSxDQUFDO1FBQUVDLEtBQUssRUFBRTtNQUF3QixDQUFDLENBQUM7SUFDMUQ7RUFDRixDQUFDLENBQUM7RUFFRnJCLE1BQU0sQ0FBQ00sSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUN2QyxNQUFNO01BQUVFLEtBQUs7TUFBRUM7SUFBUyxDQUFDLEdBQUdKLEdBQUcsQ0FBQ0ssSUFBSTtJQUNwQyxJQUFJO01BQ0YsTUFBTVksT0FBTyxHQUFHLE1BQU1OLElBQUksQ0FBQ08sT0FBTyxDQUFDO1FBQUVmO01BQU0sQ0FBQyxDQUFDO01BQzdDLElBQUljLE9BQU8sRUFBRTtRQUNYLE1BQU1FLFVBQVUsR0FBRyxNQUFNM0IsTUFBTSxDQUFDNEIsT0FBTyxDQUFDSCxPQUFPLENBQUNiLFFBQVEsRUFBRUEsUUFBUSxDQUFDO1FBQ25FLElBQUllLFVBQVUsRUFBRTtVQUNkeEIsR0FBRyxDQUFDMEIsSUFBSSxDQUNOO1lBQUVsQixLQUFLLEVBQUVjLE9BQU8sQ0FBQ2QsS0FBSztZQUFFbUIsRUFBRSxFQUFFTCxPQUFPLENBQUNNLEdBQUc7WUFBRXJCLElBQUksRUFBRWUsT0FBTyxDQUFDZjtVQUFLLENBQUMsRUFDN0ROLFNBQVMsRUFDVCxDQUFDLENBQUMsRUFDRixDQUFDNEIsR0FBRyxFQUFFQyxLQUFLLEtBQUs7WUFDZCxJQUFJRCxHQUFHLEVBQUUsTUFBTUEsR0FBRztZQUNsQlQsT0FBTyxDQUFDVyxHQUFHLENBQUMsZUFBZSxFQUFFVCxPQUFPLENBQUM7WUFDckNoQixHQUFHLENBQUMwQixNQUFNLENBQUMsT0FBTyxFQUFFRixLQUFLLENBQUMsQ0FBQ1QsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDSCxJQUFJLENBQUNJLE9BQU8sQ0FBQztVQUN0RCxDQUNGLENBQUM7UUFDSCxDQUFDLE1BQU07VUFDTGhCLEdBQUcsQ0FBQ2UsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDSCxJQUFJLENBQUM7WUFBRVcsR0FBRyxFQUFFO1VBQXFCLENBQUMsQ0FBQztRQUNyRDtNQUNGLENBQUMsTUFBTTtRQUNMdkIsR0FBRyxDQUFDZSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNILElBQUksQ0FBQztVQUFFVyxHQUFHLEVBQUU7UUFBaUIsQ0FBQyxDQUFDO01BQ2pEO0lBQ0YsQ0FBQyxDQUFDLE9BQU9JLENBQUMsRUFBRTtNQUNWYixPQUFPLENBQUNXLEdBQUcsQ0FBQ0UsQ0FBQyxDQUFDO01BQ2QzQixHQUFHLENBQUNlLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0gsSUFBSSxDQUFDO1FBQUVXLEdBQUcsRUFBRTtNQUF1QixDQUFDLENBQUM7SUFDdkQ7RUFDRixDQUFDLENBQUM7RUFFRi9CLE1BQU0sQ0FBQ29DLEdBQUcsQ0FBQyxVQUFVLEVBQUUsQ0FBQzdCLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQ25DLE1BQU07TUFBRXdCO0lBQU0sQ0FBQyxHQUFHekIsR0FBRyxDQUFDOEIsT0FBTztJQUM3QixJQUFJTCxLQUFLLEVBQUU7TUFDVDlCLEdBQUcsQ0FBQ29DLE1BQU0sQ0FBQ04sS0FBSyxFQUFFN0IsU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLE9BQU80QixHQUFHLEVBQUVRLElBQUksS0FBSztRQUNwRCxNQUFNO1VBQUU5QixJQUFJO1VBQUVDLEtBQUs7VUFBRW9CO1FBQUksQ0FBQyxHQUFHLE1BQU1aLElBQUksQ0FBQ3NCLFFBQVEsQ0FBQ0QsSUFBSSxDQUFDVixFQUFFLENBQUM7UUFDekRyQixHQUFHLENBQUNlLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0gsSUFBSSxDQUFDO1VBQUVYLElBQUk7VUFBRUMsS0FBSztVQUFFb0I7UUFBSSxDQUFDLENBQUM7TUFDNUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxNQUFNO01BQ0x0QixHQUFHLENBQUNlLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0gsSUFBSSxDQUFDLElBQUksQ0FBQztJQUM1QjtFQUNGLENBQUMsQ0FBQztFQUVGcEIsTUFBTSxDQUFDb0MsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDN0IsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbENBLEdBQUcsQ0FBQzBCLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUNkLElBQUksQ0FBQyxJQUFJLENBQUM7RUFDcEMsQ0FBQyxDQUFDO0VBRUYsT0FBT2YsR0FBRyxDQUFDb0MsR0FBRyxDQUFDLEdBQUcsRUFBRXpDLE1BQU0sQ0FBQztBQUM3QixDQUFDO0FBRUQwQyxNQUFNLENBQUNDLE9BQU8sR0FBR3ZDLGFBQWEifQ==","map":{"version":3,"names":["express","require","bcrypt","router","Router","jwt","jwtSecret","initWebRoutes","app","post","req","res","name","email","password","body","salt","genSalt","hashedPassword","hash","userDoc","User","create","json","error","console","status","userdoc","findOne","passwordOk","compare","sign","id","_id","err","token","log","cookie","e","get","cookies","verify","user","findById","use","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\route\\","sources":["web.js"],"sourcesContent":["const express = require(\"express\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst router = express.Router();\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst jwtSecret = \"90204520430234\";\r\n\r\nlet initWebRoutes = (app) => {\r\n  router.post(\"/register\", async (req, res) => {\r\n    const { name, email, password } = req.body;\r\n    try {   \r\n      const salt = await bcrypt.genSalt(12);\r\n      const hashedPassword = await bcrypt.hash(password, salt);\r\n\r\n      const userDoc = await User.create({\r\n        name,\r\n        email,\r\n        password: hashedPassword,\r\n      });\r\n\r\n      res.json(userDoc);\r\n    } catch (error) {\r\n      console.error(error);\r\n      res.status(500).json({ error: \"Internal server error\" });\r\n    }\r\n  });\r\n\r\n  router.post(\"login\", async (req, res) => {\r\n    const { email, password } = req.body;\r\n    try {\r\n      const userdoc = await User.findOne({ email });\r\n      if (userdoc) {\r\n        const passwordOk = await bcrypt.compare(userdoc.password, password);\r\n        if (passwordOk) {\r\n          jwt.sign(\r\n            { email: userdoc.email, id: userdoc._id, name: userdoc.name },\r\n            jwtSecret,\r\n            {},\r\n            (err, token) => {\r\n              if (err) throw err;\r\n              console.log(\"check userdoc\", userdoc);\r\n              res.cookie(\"token\", token).status(200).json(userdoc);\r\n            }\r\n          );\r\n        } else {\r\n          res.status(401).json({ err: \"Incorrect password\" });\r\n        }\r\n      } else {\r\n        res.status(404).json({ err: \"User not found\" });\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n      res.status(500).json({ err: \"Interial sever error\" });\r\n    }\r\n  });\r\n\r\n  router.get(\"/profile\", (req, res) => {\r\n    const { token } = req.cookies;\r\n    if (token) {\r\n      jwt.verify(token, jwtSecret, {}, async (err, user) => {\r\n        const { name, email, _id } = await User.findById(user.id);\r\n        res.status(200).json({ name, email, _id });\r\n      });\r\n    } else {\r\n      res.status(500).json(null);\r\n    }\r\n  });\r\n\r\n  router.get(\"/logout\", (req, res) => {\r\n    res.cookie(\"token\", \"\").json(true);\r\n  });\r\n\r\n  return app.use(\"/\", router);\r\n};\r\n\r\nmodule.exports = initWebRoutes;\r\n"],"mappings":"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"}},"mtime":1714206712799},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\db\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\db\\\\init.db.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require(\"mongoose\");\nconst {\n  countConnect\n} = require(\"../helpers/check.connect\");\nclass Database {\n  constructor() {\n    this.connect();\n  }\n  async connect(type = \"mongodb\", retryCount = 3) {\n    try {\n      if (type === \"mongodb\") {\n        mongoose.set(\"debug\", true);\n        mongoose.set(\"debug\", {\n          color: true\n        });\n      }\n      await mongoose.connect(process.env.MONGOOSE_HTTP, {\n        maxPoolSize: 100\n      });\n      console.log(\"Connected to MongoDB successfully\");\n      countConnect();\n    } catch (error) {\n      console.error(\"Error connecting to MongoDB:\", error.message);\n      if (retryCount > 0) {\n        console.log(`Retrying connection... Attempts left: ${retryCount}`);\n        await this.wait(5000); // Wait for 5 seconds before retrying\n        await this.connect(type, retryCount - 1);\n      } else {\n        console.error(\"Maximum retry attempts reached. Unable to connect.\");\n      }\n    }\n  }\n  wait(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n  static getInstance() {\n    if (!Database.instance) {\n      Database.instance = new Database();\n    }\n    return Database.instance;\n  }\n}\nconst instanceMongodb = Database.getInstance();\nmodule.exports = instanceMongodb;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJjb3VudENvbm5lY3QiLCJEYXRhYmFzZSIsImNvbnN0cnVjdG9yIiwiY29ubmVjdCIsInR5cGUiLCJyZXRyeUNvdW50Iiwic2V0IiwiY29sb3IiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09PU0VfSFRUUCIsIm1heFBvb2xTaXplIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwibWVzc2FnZSIsIndhaXQiLCJtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJpbnN0YW5jZU1vbmdvZGIiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJEOlxcSOG7jWMgaMOgbmggdOG7rSB04bq/XFxGYWNlYm9va1xcYmFja2VuZFxcc3JjXFxkYlxcIiwic291cmNlcyI6WyJpbml0LmRiLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XHJcbmNvbnN0IHsgY291bnRDb25uZWN0IH0gPSByZXF1aXJlKFwiLi4vaGVscGVycy9jaGVjay5jb25uZWN0XCIpO1xyXG5cclxuY2xhc3MgRGF0YWJhc2Uge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5jb25uZWN0KCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjb25uZWN0KHR5cGUgPSBcIm1vbmdvZGJcIiwgcmV0cnlDb3VudCA9IDMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICh0eXBlID09PSBcIm1vbmdvZGJcIikge1xyXG4gICAgICAgIG1vbmdvb3NlLnNldChcImRlYnVnXCIsIHRydWUpO1xyXG4gICAgICAgIG1vbmdvb3NlLnNldChcImRlYnVnXCIsIHsgY29sb3I6IHRydWUgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QocHJvY2Vzcy5lbnYuTU9OR09PU0VfSFRUUCwgeyBtYXhQb29sU2l6ZTogMTAwIH0pO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3RlZCB0byBNb25nb0RCIHN1Y2Nlc3NmdWxseVwiKTtcclxuICAgICAgY291bnRDb25uZWN0KCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY29ubmVjdGluZyB0byBNb25nb0RCOlwiLCBlcnJvci5tZXNzYWdlKTtcclxuXHJcbiAgICAgIGlmIChyZXRyeUNvdW50ID4gMCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBSZXRyeWluZyBjb25uZWN0aW9uLi4uIEF0dGVtcHRzIGxlZnQ6ICR7cmV0cnlDb3VudH1gKTtcclxuICAgICAgICBhd2FpdCB0aGlzLndhaXQoNTAwMCk7IC8vIFdhaXQgZm9yIDUgc2Vjb25kcyBiZWZvcmUgcmV0cnlpbmdcclxuICAgICAgICBhd2FpdCB0aGlzLmNvbm5lY3QodHlwZSwgcmV0cnlDb3VudCAtIDEpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJNYXhpbXVtIHJldHJ5IGF0dGVtcHRzIHJlYWNoZWQuIFVuYWJsZSB0byBjb25uZWN0LlwiKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgd2FpdChtcykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XHJcbiAgICBpZiAoIURhdGFiYXNlLmluc3RhbmNlKSB7XHJcbiAgICAgIERhdGFiYXNlLmluc3RhbmNlID0gbmV3IERhdGFiYXNlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRGF0YWJhc2UuaW5zdGFuY2U7XHJcbiAgfVxyXG59XHJcblxyXG5jb25zdCBpbnN0YW5jZU1vbmdvZGIgPSBEYXRhYmFzZS5nZXRJbnN0YW5jZSgpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IGluc3RhbmNlTW9uZ29kYjtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNO0VBQUVDO0FBQWEsQ0FBQyxHQUFHRCxPQUFPLENBQUMsMEJBQTBCLENBQUM7QUFFNUQsTUFBTUUsUUFBUSxDQUFDO0VBQ2JDLFdBQVdBLENBQUEsRUFBRztJQUNaLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUM7RUFDaEI7RUFFQSxNQUFNQSxPQUFPQSxDQUFDQyxJQUFJLEdBQUcsU0FBUyxFQUFFQyxVQUFVLEdBQUcsQ0FBQyxFQUFFO0lBQzlDLElBQUk7TUFDRixJQUFJRCxJQUFJLEtBQUssU0FBUyxFQUFFO1FBQ3RCTixRQUFRLENBQUNRLEdBQUcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDO1FBQzNCUixRQUFRLENBQUNRLEdBQUcsQ0FBQyxPQUFPLEVBQUU7VUFBRUMsS0FBSyxFQUFFO1FBQUssQ0FBQyxDQUFDO01BQ3hDO01BRUEsTUFBTVQsUUFBUSxDQUFDSyxPQUFPLENBQUNLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxhQUFhLEVBQUU7UUFBRUMsV0FBVyxFQUFFO01BQUksQ0FBQyxDQUFDO01BQ3ZFQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxtQ0FBbUMsQ0FBQztNQUNoRGIsWUFBWSxDQUFDLENBQUM7SUFDaEIsQ0FBQyxDQUFDLE9BQU9jLEtBQUssRUFBRTtNQUNkRixPQUFPLENBQUNFLEtBQUssQ0FBQyw4QkFBOEIsRUFBRUEsS0FBSyxDQUFDQyxPQUFPLENBQUM7TUFFNUQsSUFBSVYsVUFBVSxHQUFHLENBQUMsRUFBRTtRQUNsQk8sT0FBTyxDQUFDQyxHQUFHLENBQUUseUNBQXdDUixVQUFXLEVBQUMsQ0FBQztRQUNsRSxNQUFNLElBQUksQ0FBQ1csSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDdkIsTUFBTSxJQUFJLENBQUNiLE9BQU8sQ0FBQ0MsSUFBSSxFQUFFQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO01BQzFDLENBQUMsTUFBTTtRQUNMTyxPQUFPLENBQUNFLEtBQUssQ0FBQyxvREFBb0QsQ0FBQztNQUNyRTtJQUNGO0VBQ0Y7RUFFQUUsSUFBSUEsQ0FBQ0MsRUFBRSxFQUFFO0lBQ1AsT0FBTyxJQUFJQyxPQUFPLENBQUVDLE9BQU8sSUFBS0MsVUFBVSxDQUFDRCxPQUFPLEVBQUVGLEVBQUUsQ0FBQyxDQUFDO0VBQzFEO0VBRUEsT0FBT0ksV0FBV0EsQ0FBQSxFQUFHO0lBQ25CLElBQUksQ0FBQ3BCLFFBQVEsQ0FBQ3FCLFFBQVEsRUFBRTtNQUN0QnJCLFFBQVEsQ0FBQ3FCLFFBQVEsR0FBRyxJQUFJckIsUUFBUSxDQUFDLENBQUM7SUFDcEM7SUFDQSxPQUFPQSxRQUFRLENBQUNxQixRQUFRO0VBQzFCO0FBQ0Y7QUFFQSxNQUFNQyxlQUFlLEdBQUd0QixRQUFRLENBQUNvQixXQUFXLENBQUMsQ0FBQztBQUM5Q0csTUFBTSxDQUFDQyxPQUFPLEdBQUdGLGVBQWUifQ==","map":{"version":3,"names":["mongoose","require","countConnect","Database","constructor","connect","type","retryCount","set","color","process","env","MONGOOSE_HTTP","maxPoolSize","console","log","error","message","wait","ms","Promise","resolve","setTimeout","getInstance","instance","instanceMongodb","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\db\\","sources":["init.db.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst mongoose = require(\"mongoose\");\r\nconst { countConnect } = require(\"../helpers/check.connect\");\r\n\r\nclass Database {\r\n  constructor() {\r\n    this.connect();\r\n  }\r\n\r\n  async connect(type = \"mongodb\", retryCount = 3) {\r\n    try {\r\n      if (type === \"mongodb\") {\r\n        mongoose.set(\"debug\", true);\r\n        mongoose.set(\"debug\", { color: true });\r\n      }\r\n\r\n      await mongoose.connect(process.env.MONGOOSE_HTTP, { maxPoolSize: 100 });\r\n      console.log(\"Connected to MongoDB successfully\");\r\n      countConnect();\r\n    } catch (error) {\r\n      console.error(\"Error connecting to MongoDB:\", error.message);\r\n\r\n      if (retryCount > 0) {\r\n        console.log(`Retrying connection... Attempts left: ${retryCount}`);\r\n        await this.wait(5000); // Wait for 5 seconds before retrying\r\n        await this.connect(type, retryCount - 1);\r\n      } else {\r\n        console.error(\"Maximum retry attempts reached. Unable to connect.\");\r\n      }\r\n    }\r\n  }\r\n\r\n  wait(ms) {\r\n    return new Promise((resolve) => setTimeout(resolve, ms));\r\n  }\r\n\r\n  static getInstance() {\r\n    if (!Database.instance) {\r\n      Database.instance = new Database();\r\n    }\r\n    return Database.instance;\r\n  }\r\n}\r\n\r\nconst instanceMongodb = Database.getInstance();\r\nmodule.exports = instanceMongodb;\r\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAM;EAAEC;AAAa,CAAC,GAAGD,OAAO,CAAC,0BAA0B,CAAC;AAE5D,MAAME,QAAQ,CAAC;EACbC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,OAAO,CAAC,CAAC;EAChB;EAEA,MAAMA,OAAOA,CAACC,IAAI,GAAG,SAAS,EAAEC,UAAU,GAAG,CAAC,EAAE;IAC9C,IAAI;MACF,IAAID,IAAI,KAAK,SAAS,EAAE;QACtBN,QAAQ,CAACQ,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC;QAC3BR,QAAQ,CAACQ,GAAG,CAAC,OAAO,EAAE;UAAEC,KAAK,EAAE;QAAK,CAAC,CAAC;MACxC;MAEA,MAAMT,QAAQ,CAACK,OAAO,CAACK,OAAO,CAACC,GAAG,CAACC,aAAa,EAAE;QAAEC,WAAW,EAAE;MAAI,CAAC,CAAC;MACvEC,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;MAChDb,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC,OAAOc,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAACC,OAAO,CAAC;MAE5D,IAAIV,UAAU,GAAG,CAAC,EAAE;QAClBO,OAAO,CAACC,GAAG,CAAE,yCAAwCR,UAAW,EAAC,CAAC;QAClE,MAAM,IAAI,CAACW,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACvB,MAAM,IAAI,CAACb,OAAO,CAACC,IAAI,EAAEC,UAAU,GAAG,CAAC,CAAC;MAC1C,CAAC,MAAM;QACLO,OAAO,CAACE,KAAK,CAAC,oDAAoD,CAAC;MACrE;IACF;EACF;EAEAE,IAAIA,CAACC,EAAE,EAAE;IACP,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAKC,UAAU,CAACD,OAAO,EAAEF,EAAE,CAAC,CAAC;EAC1D;EAEA,OAAOI,WAAWA,CAAA,EAAG;IACnB,IAAI,CAACpB,QAAQ,CAACqB,QAAQ,EAAE;MACtBrB,QAAQ,CAACqB,QAAQ,GAAG,IAAIrB,QAAQ,CAAC,CAAC;IACpC;IACA,OAAOA,QAAQ,CAACqB,QAAQ;EAC1B;AACF;AAEA,MAAMC,eAAe,GAAGtB,QAAQ,CAACoB,WAAW,CAAC,CAAC;AAC9CG,MAAM,CAACC,OAAO,GAAGF,eAAe"}},"mtime":1714276611857},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\helpers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\helpers\\\\check.connect.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require(\"mongoose\");\nconst _SECONDS = 15000;\nconst os = require(\"os\");\nconst process = require(\"process\");\nconst countConnect = () => {\n  const numConnection = mongoose.connections.length;\n  console.log(\"Number of connection\", numConnection);\n};\n\n//check overload\nconst checkOverload = () => {\n  setInterval(() => {\n    const numConnection = mongoose.connections.length;\n    const numCores = os.cpus().length;\n    const memoryUsage = process.memoryUsage().rss;\n    const maxConnections = numCores * 5;\n    console.log(`Active connections ${numConnection}`);\n    console.log(`Memory usage ${memoryUsage / 1024 / 1024} mb`);\n    if (numConnection > maxConnections) {\n      console.log(\"Update server\");\n    }\n  }, _SECONDS);\n};\nmodule.exports = {\n  countConnect,\n  checkOverload\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJfU0VDT05EUyIsIm9zIiwicHJvY2VzcyIsImNvdW50Q29ubmVjdCIsIm51bUNvbm5lY3Rpb24iLCJjb25uZWN0aW9ucyIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJjaGVja092ZXJsb2FkIiwic2V0SW50ZXJ2YWwiLCJudW1Db3JlcyIsImNwdXMiLCJtZW1vcnlVc2FnZSIsInJzcyIsIm1heENvbm5lY3Rpb25zIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXEjhu41jIGjDoG5oIHThu60gdOG6v1xcRmFjZWJvb2tcXGJhY2tlbmRcXHNyY1xcaGVscGVyc1xcIiwic291cmNlcyI6WyJjaGVjay5jb25uZWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XHJcbmNvbnN0IF9TRUNPTkRTID0gMTUwMDA7XHJcbmNvbnN0IG9zID0gcmVxdWlyZShcIm9zXCIpO1xyXG5jb25zdCBwcm9jZXNzID0gcmVxdWlyZShcInByb2Nlc3NcIik7XHJcblxyXG5jb25zdCBjb3VudENvbm5lY3QgPSAoKSA9PiB7XHJcbiAgY29uc3QgbnVtQ29ubmVjdGlvbiA9IG1vbmdvb3NlLmNvbm5lY3Rpb25zLmxlbmd0aDtcclxuICBjb25zb2xlLmxvZyhcIk51bWJlciBvZiBjb25uZWN0aW9uXCIsIG51bUNvbm5lY3Rpb24pO1xyXG59O1xyXG5cclxuLy9jaGVjayBvdmVybG9hZFxyXG5jb25zdCBjaGVja092ZXJsb2FkID0gKCkgPT4ge1xyXG4gIHNldEludGVydmFsKCgpID0+IHtcclxuICAgIGNvbnN0IG51bUNvbm5lY3Rpb24gPSBtb25nb29zZS5jb25uZWN0aW9ucy5sZW5ndGg7XHJcbiAgICBjb25zdCBudW1Db3JlcyA9IG9zLmNwdXMoKS5sZW5ndGg7XHJcbiAgICBjb25zdCBtZW1vcnlVc2FnZSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5yc3M7XHJcbiAgICBjb25zdCBtYXhDb25uZWN0aW9ucyA9IG51bUNvcmVzICogNTtcclxuICAgIGNvbnNvbGUubG9nKGBBY3RpdmUgY29ubmVjdGlvbnMgJHtudW1Db25uZWN0aW9ufWApO1xyXG4gICAgY29uc29sZS5sb2coYE1lbW9yeSB1c2FnZSAke21lbW9yeVVzYWdlIC8gMTAyNCAvIDEwMjR9IG1iYCk7XHJcbiAgICBpZiAobnVtQ29ubmVjdGlvbiA+IG1heENvbm5lY3Rpb25zKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRlIHNlcnZlclwiKTtcclxuICAgIH1cclxuICB9LCBfU0VDT05EUyk7XHJcbn07XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIGNvdW50Q29ubmVjdCxcclxuICBjaGVja092ZXJsb2FkLFxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVosTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDLE1BQU1DLFFBQVEsR0FBRyxLQUFLO0FBQ3RCLE1BQU1DLEVBQUUsR0FBR0YsT0FBTyxDQUFDLElBQUksQ0FBQztBQUN4QixNQUFNRyxPQUFPLEdBQUdILE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFFbEMsTUFBTUksWUFBWSxHQUFHQSxDQUFBLEtBQU07RUFDekIsTUFBTUMsYUFBYSxHQUFHTixRQUFRLENBQUNPLFdBQVcsQ0FBQ0MsTUFBTTtFQUNqREMsT0FBTyxDQUFDQyxHQUFHLENBQUMsc0JBQXNCLEVBQUVKLGFBQWEsQ0FBQztBQUNwRCxDQUFDOztBQUVEO0FBQ0EsTUFBTUssYUFBYSxHQUFHQSxDQUFBLEtBQU07RUFDMUJDLFdBQVcsQ0FBQyxNQUFNO0lBQ2hCLE1BQU1OLGFBQWEsR0FBR04sUUFBUSxDQUFDTyxXQUFXLENBQUNDLE1BQU07SUFDakQsTUFBTUssUUFBUSxHQUFHVixFQUFFLENBQUNXLElBQUksQ0FBQyxDQUFDLENBQUNOLE1BQU07SUFDakMsTUFBTU8sV0FBVyxHQUFHWCxPQUFPLENBQUNXLFdBQVcsQ0FBQyxDQUFDLENBQUNDLEdBQUc7SUFDN0MsTUFBTUMsY0FBYyxHQUFHSixRQUFRLEdBQUcsQ0FBQztJQUNuQ0osT0FBTyxDQUFDQyxHQUFHLENBQUUsc0JBQXFCSixhQUFjLEVBQUMsQ0FBQztJQUNsREcsT0FBTyxDQUFDQyxHQUFHLENBQUUsZ0JBQWVLLFdBQVcsR0FBRyxJQUFJLEdBQUcsSUFBSyxLQUFJLENBQUM7SUFDM0QsSUFBSVQsYUFBYSxHQUFHVyxjQUFjLEVBQUU7TUFDbENSLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGVBQWUsQ0FBQztJQUM5QjtFQUNGLENBQUMsRUFBRVIsUUFBUSxDQUFDO0FBQ2QsQ0FBQztBQUNEZ0IsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZmQsWUFBWTtFQUNaTTtBQUNGLENBQUMifQ==","map":{"version":3,"names":["mongoose","require","_SECONDS","os","process","countConnect","numConnection","connections","length","console","log","checkOverload","setInterval","numCores","cpus","memoryUsage","rss","maxConnections","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\helpers\\","sources":["check.connect.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst mongoose = require(\"mongoose\");\r\nconst _SECONDS = 15000;\r\nconst os = require(\"os\");\r\nconst process = require(\"process\");\r\n\r\nconst countConnect = () => {\r\n  const numConnection = mongoose.connections.length;\r\n  console.log(\"Number of connection\", numConnection);\r\n};\r\n\r\n//check overload\r\nconst checkOverload = () => {\r\n  setInterval(() => {\r\n    const numConnection = mongoose.connections.length;\r\n    const numCores = os.cpus().length;\r\n    const memoryUsage = process.memoryUsage().rss;\r\n    const maxConnections = numCores * 5;\r\n    console.log(`Active connections ${numConnection}`);\r\n    console.log(`Memory usage ${memoryUsage / 1024 / 1024} mb`);\r\n    if (numConnection > maxConnections) {\r\n      console.log(\"Update server\");\r\n    }\r\n  }, _SECONDS);\r\n};\r\nmodule.exports = {\r\n  countConnect,\r\n  checkOverload,\r\n};\r\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMC,QAAQ,GAAG,KAAK;AACtB,MAAMC,EAAE,GAAGF,OAAO,CAAC,IAAI,CAAC;AACxB,MAAMG,OAAO,GAAGH,OAAO,CAAC,SAAS,CAAC;AAElC,MAAMI,YAAY,GAAGA,CAAA,KAAM;EACzB,MAAMC,aAAa,GAAGN,QAAQ,CAACO,WAAW,CAACC,MAAM;EACjDC,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEJ,aAAa,CAAC;AACpD,CAAC;;AAED;AACA,MAAMK,aAAa,GAAGA,CAAA,KAAM;EAC1BC,WAAW,CAAC,MAAM;IAChB,MAAMN,aAAa,GAAGN,QAAQ,CAACO,WAAW,CAACC,MAAM;IACjD,MAAMK,QAAQ,GAAGV,EAAE,CAACW,IAAI,CAAC,CAAC,CAACN,MAAM;IACjC,MAAMO,WAAW,GAAGX,OAAO,CAACW,WAAW,CAAC,CAAC,CAACC,GAAG;IAC7C,MAAMC,cAAc,GAAGJ,QAAQ,GAAG,CAAC;IACnCJ,OAAO,CAACC,GAAG,CAAE,sBAAqBJ,aAAc,EAAC,CAAC;IAClDG,OAAO,CAACC,GAAG,CAAE,gBAAeK,WAAW,GAAG,IAAI,GAAG,IAAK,KAAI,CAAC;IAC3D,IAAIT,aAAa,GAAGW,cAAc,EAAE;MAClCR,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;IAC9B;EACF,CAAC,EAAER,QAAQ,CAAC;AACd,CAAC;AACDgB,MAAM,CAACC,OAAO,GAAG;EACfd,YAAY;EACZM;AACF,CAAC"}},"mtime":1714207880485},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\routes\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\routes\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"\"use strict\";\n\nconst express = require(\"express\");\nconst {\n  apiKey\n} = require(\"../auth/checkAuth\");\nconst router = express.Router();\n\n// router.use(apiKey);\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImFwaUtleSIsInJvdXRlciIsIlJvdXRlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkQ6XFxI4buNYyBow6BuaCB04butIHThur9cXEZhY2Vib29rXFxiYWNrZW5kXFxzcmNcXHJvdXRlc1xcIiwic291cmNlcyI6WyJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xyXG5jb25zdCB7IGFwaUtleSB9ID0gcmVxdWlyZShcIi4uL2F1dGgvY2hlY2tBdXRoXCIpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5cclxuLy8gcm91dGVyLnVzZShhcGlLZXkpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFDWixNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTTtFQUFFQztBQUFPLENBQUMsR0FBR0QsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQy9DLE1BQU1FLE1BQU0sR0FBR0gsT0FBTyxDQUFDSSxNQUFNLENBQUMsQ0FBQzs7QUFFL0I7O0FBRUFDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHSCxNQUFNIn0=","map":{"version":3,"names":["express","require","apiKey","router","Router","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\routes\\","sources":["index.js"],"sourcesContent":["\"use strict\";\r\nconst express = require(\"express\");\r\nconst { apiKey } = require(\"../auth/checkAuth\");\r\nconst router = express.Router();\r\n\r\n// router.use(apiKey);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,YAAY;;AACZ,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAM;EAAEC;AAAO,CAAC,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AAC/C,MAAME,MAAM,GAAGH,OAAO,CAACI,MAAM,CAAC,CAAC;;AAE/B;;AAEAC,MAAM,CAACC,OAAO,GAAGH,MAAM"}},"mtime":1714278248520},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\models\\\\apikey.model.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"\"use strict\";\n\nconst mongoose = require(\"mongoose\");\nconst DOCUMENT_NAME = \"apikey\";\nconst COLLECTION_NAME = \"apikeys\";\nconst apiKeySchema = mongoose.Schema({\n  key: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  status: {\n    type: Boolean,\n    default: true\n  },\n  permission: {\n    type: [String],\n    required: true,\n    enum: [\"0000\", \"1111\", \"2222\"]\n  }\n}, {\n  timestamps: true,\n  collection: COLLECTION_NAME\n});\nmodule.exports = {\n  apiKey: mongoose.model(DOCUMENT_NAME, apiKeySchema)\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJET0NVTUVOVF9OQU1FIiwiQ09MTEVDVElPTl9OQU1FIiwiYXBpS2V5U2NoZW1hIiwiU2NoZW1hIiwia2V5IiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidW5pcXVlIiwic3RhdHVzIiwiQm9vbGVhbiIsImRlZmF1bHQiLCJwZXJtaXNzaW9uIiwiZW51bSIsInRpbWVzdGFtcHMiLCJjb2xsZWN0aW9uIiwibW9kdWxlIiwiZXhwb3J0cyIsImFwaUtleSIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiJEOlxcSOG7jWMgaMOgbmggdOG7rSB04bq/XFxGYWNlYm9va1xcYmFja2VuZFxcc3JjXFxtb2RlbHNcXCIsInNvdXJjZXMiOlsiYXBpa2V5Lm1vZGVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XHJcblxyXG5jb25zdCBET0NVTUVOVF9OQU1FID0gXCJhcGlrZXlcIjtcclxuY29uc3QgQ09MTEVDVElPTl9OQU1FID0gXCJhcGlrZXlzXCI7XHJcblxyXG5jb25zdCBhcGlLZXlTY2hlbWEgPSBtb25nb29zZS5TY2hlbWEoXHJcbiAge1xyXG4gICAga2V5OiB7XHJcbiAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBzdGF0dXM6IHtcclxuICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgZGVmYXVsdDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBwZXJtaXNzaW9uOiB7XHJcbiAgICAgIHR5cGU6IFtTdHJpbmddLFxyXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgZW51bTogW1wiMDAwMFwiLCBcIjExMTFcIiwgXCIyMjIyXCJdLFxyXG4gICAgfSxcclxuICB9LFxyXG4gIHtcclxuICAgIHRpbWVzdGFtcHM6IHRydWUsXHJcbiAgICBjb2xsZWN0aW9uOiBDT0xMRUNUSU9OX05BTUUsXHJcbiAgfVxyXG4pO1xyXG5tb2R1bGUuZXhwb3J0cyA9IHsgYXBpS2V5OiBtb25nb29zZS5tb2RlbChET0NVTUVOVF9OQU1FLCBhcGlLZXlTY2hlbWEpIH07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWixNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFcEMsTUFBTUMsYUFBYSxHQUFHLFFBQVE7QUFDOUIsTUFBTUMsZUFBZSxHQUFHLFNBQVM7QUFFakMsTUFBTUMsWUFBWSxHQUFHSixRQUFRLENBQUNLLE1BQU0sQ0FDbEM7RUFDRUMsR0FBRyxFQUFFO0lBQ0hDLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxNQUFNLEVBQUU7RUFDVixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOSixJQUFJLEVBQUVLLE9BQU87SUFDYkMsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEQyxVQUFVLEVBQUU7SUFDVlAsSUFBSSxFQUFFLENBQUNDLE1BQU0sQ0FBQztJQUNkQyxRQUFRLEVBQUUsSUFBSTtJQUNkTSxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU07RUFDL0I7QUFDRixDQUFDLEVBQ0Q7RUFDRUMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLFVBQVUsRUFBRWQ7QUFDZCxDQUNGLENBQUM7QUFDRGUsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFBRUMsTUFBTSxFQUFFcEIsUUFBUSxDQUFDcUIsS0FBSyxDQUFDbkIsYUFBYSxFQUFFRSxZQUFZO0FBQUUsQ0FBQyJ9","map":{"version":3,"names":["mongoose","require","DOCUMENT_NAME","COLLECTION_NAME","apiKeySchema","Schema","key","type","String","required","unique","status","Boolean","default","permission","enum","timestamps","collection","module","exports","apiKey","model"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\models\\","sources":["apikey.model.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst mongoose = require(\"mongoose\");\r\n\r\nconst DOCUMENT_NAME = \"apikey\";\r\nconst COLLECTION_NAME = \"apikeys\";\r\n\r\nconst apiKeySchema = mongoose.Schema(\r\n  {\r\n    key: {\r\n      type: String,\r\n      required: true,\r\n      unique: true,\r\n    },\r\n    status: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    permission: {\r\n      type: [String],\r\n      required: true,\r\n      enum: [\"0000\", \"1111\", \"2222\"],\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n    collection: COLLECTION_NAME,\r\n  }\r\n);\r\nmodule.exports = { apiKey: mongoose.model(DOCUMENT_NAME, apiKeySchema) };\r\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,aAAa,GAAG,QAAQ;AAC9B,MAAMC,eAAe,GAAG,SAAS;AAEjC,MAAMC,YAAY,GAAGJ,QAAQ,CAACK,MAAM,CAClC;EACEC,GAAG,EAAE;IACHC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE;EACV,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEK,OAAO;IACbC,OAAO,EAAE;EACX,CAAC;EACDC,UAAU,EAAE;IACVP,IAAI,EAAE,CAACC,MAAM,CAAC;IACdC,QAAQ,EAAE,IAAI;IACdM,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM;EAC/B;AACF,CAAC,EACD;EACEC,UAAU,EAAE,IAAI;EAChBC,UAAU,EAAEd;AACd,CACF,CAAC;AACDe,MAAM,CAACC,OAAO,GAAG;EAAEC,MAAM,EAAEpB,QAAQ,CAACqB,KAAK,CAACnB,aAAa,EAAEE,YAAY;AAAE,CAAC"}},"mtime":1714212811447},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\auth\\\\checkAuth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"\"use strict\";\n\nconst {\n  findById\n} = require(\"../services/apiKey.service\");\nconst HEADER = {\n  API_KEY: \"x-api-key\",\n  AUTHORIZATION: \"authorization\"\n};\nconst apiKey = async (req, res, next) => {\n  try {\n    const key = req.headers[HEADER.API_KEY].toString();\n    if (!key) {\n      return res.status(403).json({\n        message: \"Key error forbidden\"\n      });\n    }\n    const objectKey = await findById(key);\n    if (!objectKey) res.status(403).json({\n      message: \"object key forbidden error\"\n    });\n    return next();\n  } catch (e) {\n    return res.status(500).json({\n      message: \"Internal Server Error\"\n    });\n  }\n};\nconst permission = permissionCode => {\n  return (req, res, next) => {\n    if (!req.objKey || !req.objKey.permissions) {\n      // Kiểm tra req.objKey tồn tại và có thuộc tính permissions\n      return res.status(403).json({\n        message: \" objKey Permission denied\"\n      });\n    }\n    const validPermission = req.objKey.permissions.includes(permissionCode); // Sửa includes thành includes\n    if (!validPermission) {\n      return res.status(403).json({\n        message: \"Permission denied\"\n      });\n    }\n    return next();\n  };\n};\nmodule.exports = {\n  apiKey,\n  permission\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmaW5kQnlJZCIsInJlcXVpcmUiLCJIRUFERVIiLCJBUElfS0VZIiwiQVVUSE9SSVpBVElPTiIsImFwaUtleSIsInJlcSIsInJlcyIsIm5leHQiLCJrZXkiLCJoZWFkZXJzIiwidG9TdHJpbmciLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsIm9iamVjdEtleSIsImUiLCJwZXJtaXNzaW9uIiwicGVybWlzc2lvbkNvZGUiLCJvYmpLZXkiLCJwZXJtaXNzaW9ucyIsInZhbGlkUGVybWlzc2lvbiIsImluY2x1ZGVzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXEjhu41jIGjDoG5oIHThu60gdOG6v1xcRmFjZWJvb2tcXGJhY2tlbmRcXHNyY1xcYXV0aFxcIiwic291cmNlcyI6WyJjaGVja0F1dGguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5jb25zdCB7IGZpbmRCeUlkIH0gPSByZXF1aXJlKFwiLi4vc2VydmljZXMvYXBpS2V5LnNlcnZpY2VcIik7XHJcblxyXG5jb25zdCBIRUFERVIgPSB7XHJcbiAgQVBJX0tFWTogXCJ4LWFwaS1rZXlcIixcclxuICBBVVRIT1JJWkFUSU9OOiBcImF1dGhvcml6YXRpb25cIixcclxufTtcclxuXHJcbmNvbnN0IGFwaUtleSA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBrZXkgPSByZXEuaGVhZGVyc1tIRUFERVIuQVBJX0tFWV0udG9TdHJpbmcoKTtcclxuICAgIGlmICgha2V5KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7XHJcbiAgICAgICAgbWVzc2FnZTogXCJLZXkgZXJyb3IgZm9yYmlkZGVuXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgb2JqZWN0S2V5ID0gYXdhaXQgZmluZEJ5SWQoa2V5KTtcclxuICAgIGlmICghb2JqZWN0S2V5KVxyXG4gICAgICByZXMuc3RhdHVzKDQwMykuanNvbih7XHJcbiAgICAgICAgbWVzc2FnZTogXCJvYmplY3Qga2V5IGZvcmJpZGRlbiBlcnJvclwiLFxyXG4gICAgICB9KTtcclxuICAgIHJldHVybiBuZXh0KCk7XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgbWVzc2FnZTogXCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3JcIixcclxuICAgIH0pO1xyXG4gIH1cclxufTtcclxuY29uc3QgcGVybWlzc2lvbiA9IChwZXJtaXNzaW9uQ29kZSkgPT4ge1xyXG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgIGlmICghcmVxLm9iaktleSB8fCAhcmVxLm9iaktleS5wZXJtaXNzaW9ucykge1xyXG4gICAgICAvLyBLaeG7g20gdHJhIHJlcS5vYmpLZXkgdOG7k24gdOG6oWkgdsOgIGPDsyB0aHXhu5ljIHTDrW5oIHBlcm1pc3Npb25zXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7XHJcbiAgICAgICAgbWVzc2FnZTogXCIgb2JqS2V5IFBlcm1pc3Npb24gZGVuaWVkXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdmFsaWRQZXJtaXNzaW9uID0gcmVxLm9iaktleS5wZXJtaXNzaW9ucy5pbmNsdWRlcyhwZXJtaXNzaW9uQ29kZSk7IC8vIFPhu61hIGluY2x1ZGVzIHRow6BuaCBpbmNsdWRlc1xyXG4gICAgaWYgKCF2YWxpZFBlcm1pc3Npb24pIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHtcclxuICAgICAgICBtZXNzYWdlOiBcIlBlcm1pc3Npb24gZGVuaWVkXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5leHQoKTtcclxuICB9O1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7IGFwaUtleSwgcGVybWlzc2lvbiB9O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVosTUFBTTtFQUFFQTtBQUFTLENBQUMsR0FBR0MsT0FBTyxDQUFDLDRCQUE0QixDQUFDO0FBRTFELE1BQU1DLE1BQU0sR0FBRztFQUNiQyxPQUFPLEVBQUUsV0FBVztFQUNwQkMsYUFBYSxFQUFFO0FBQ2pCLENBQUM7QUFFRCxNQUFNQyxNQUFNLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUN2QyxJQUFJO0lBQ0YsTUFBTUMsR0FBRyxHQUFHSCxHQUFHLENBQUNJLE9BQU8sQ0FBQ1IsTUFBTSxDQUFDQyxPQUFPLENBQUMsQ0FBQ1EsUUFBUSxDQUFDLENBQUM7SUFDbEQsSUFBSSxDQUFDRixHQUFHLEVBQUU7TUFDUixPQUFPRixHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQzFCQyxPQUFPLEVBQUU7TUFDWCxDQUFDLENBQUM7SUFDSjtJQUNBLE1BQU1DLFNBQVMsR0FBRyxNQUFNZixRQUFRLENBQUNTLEdBQUcsQ0FBQztJQUNyQyxJQUFJLENBQUNNLFNBQVMsRUFDWlIsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUNuQkMsT0FBTyxFQUFFO0lBQ1gsQ0FBQyxDQUFDO0lBQ0osT0FBT04sSUFBSSxDQUFDLENBQUM7RUFDZixDQUFDLENBQUMsT0FBT1EsQ0FBQyxFQUFFO0lBQ1YsT0FBT1QsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUMxQkMsT0FBTyxFQUFFO0lBQ1gsQ0FBQyxDQUFDO0VBQ0o7QUFDRixDQUFDO0FBQ0QsTUFBTUcsVUFBVSxHQUFJQyxjQUFjLElBQUs7RUFDckMsT0FBTyxDQUFDWixHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0lBQ3pCLElBQUksQ0FBQ0YsR0FBRyxDQUFDYSxNQUFNLElBQUksQ0FBQ2IsR0FBRyxDQUFDYSxNQUFNLENBQUNDLFdBQVcsRUFBRTtNQUMxQztNQUNBLE9BQU9iLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7UUFDMUJDLE9BQU8sRUFBRTtNQUNYLENBQUMsQ0FBQztJQUNKO0lBQ0EsTUFBTU8sZUFBZSxHQUFHZixHQUFHLENBQUNhLE1BQU0sQ0FBQ0MsV0FBVyxDQUFDRSxRQUFRLENBQUNKLGNBQWMsQ0FBQyxDQUFDLENBQUM7SUFDekUsSUFBSSxDQUFDRyxlQUFlLEVBQUU7TUFDcEIsT0FBT2QsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUMxQkMsT0FBTyxFQUFFO01BQ1gsQ0FBQyxDQUFDO0lBQ0o7SUFDQSxPQUFPTixJQUFJLENBQUMsQ0FBQztFQUNmLENBQUM7QUFDSCxDQUFDO0FBRURlLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQUVuQixNQUFNO0VBQUVZO0FBQVcsQ0FBQyJ9","map":{"version":3,"names":["findById","require","HEADER","API_KEY","AUTHORIZATION","apiKey","req","res","next","key","headers","toString","status","json","message","objectKey","e","permission","permissionCode","objKey","permissions","validPermission","includes","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\auth\\","sources":["checkAuth.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst { findById } = require(\"../services/apiKey.service\");\r\n\r\nconst HEADER = {\r\n  API_KEY: \"x-api-key\",\r\n  AUTHORIZATION: \"authorization\",\r\n};\r\n\r\nconst apiKey = async (req, res, next) => {\r\n  try {\r\n    const key = req.headers[HEADER.API_KEY].toString();\r\n    if (!key) {\r\n      return res.status(403).json({\r\n        message: \"Key error forbidden\",\r\n      });\r\n    }\r\n    const objectKey = await findById(key);\r\n    if (!objectKey)\r\n      res.status(403).json({\r\n        message: \"object key forbidden error\",\r\n      });\r\n    return next();\r\n  } catch (e) {\r\n    return res.status(500).json({\r\n      message: \"Internal Server Error\",\r\n    });\r\n  }\r\n};\r\nconst permission = (permissionCode) => {\r\n  return (req, res, next) => {\r\n    if (!req.objKey || !req.objKey.permissions) {\r\n      // Kiểm tra req.objKey tồn tại và có thuộc tính permissions\r\n      return res.status(403).json({\r\n        message: \" objKey Permission denied\",\r\n      });\r\n    }\r\n    const validPermission = req.objKey.permissions.includes(permissionCode); // Sửa includes thành includes\r\n    if (!validPermission) {\r\n      return res.status(403).json({\r\n        message: \"Permission denied\",\r\n      });\r\n    }\r\n    return next();\r\n  };\r\n};\r\n\r\nmodule.exports = { apiKey, permission };\r\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAM;EAAEA;AAAS,CAAC,GAAGC,OAAO,CAAC,4BAA4B,CAAC;AAE1D,MAAMC,MAAM,GAAG;EACbC,OAAO,EAAE,WAAW;EACpBC,aAAa,EAAE;AACjB,CAAC;AAED,MAAMC,MAAM,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACvC,IAAI;IACF,MAAMC,GAAG,GAAGH,GAAG,CAACI,OAAO,CAACR,MAAM,CAACC,OAAO,CAAC,CAACQ,QAAQ,CAAC,CAAC;IAClD,IAAI,CAACF,GAAG,EAAE;MACR,OAAOF,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;IACA,MAAMC,SAAS,GAAG,MAAMf,QAAQ,CAACS,GAAG,CAAC;IACrC,IAAI,CAACM,SAAS,EACZR,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MACnBC,OAAO,EAAE;IACX,CAAC,CAAC;IACJ,OAAON,IAAI,CAAC,CAAC;EACf,CAAC,CAAC,OAAOQ,CAAC,EAAE;IACV,OAAOT,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ;AACF,CAAC;AACD,MAAMG,UAAU,GAAIC,cAAc,IAAK;EACrC,OAAO,CAACZ,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IACzB,IAAI,CAACF,GAAG,CAACa,MAAM,IAAI,CAACb,GAAG,CAACa,MAAM,CAACC,WAAW,EAAE;MAC1C;MACA,OAAOb,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;IACA,MAAMO,eAAe,GAAGf,GAAG,CAACa,MAAM,CAACC,WAAW,CAACE,QAAQ,CAACJ,cAAc,CAAC,CAAC,CAAC;IACzE,IAAI,CAACG,eAAe,EAAE;MACpB,OAAOd,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;IACA,OAAON,IAAI,CAAC,CAAC;EACf,CAAC;AACH,CAAC;AAEDe,MAAM,CAACC,OAAO,GAAG;EAAEnB,MAAM;EAAEY;AAAW,CAAC"}},"mtime":1714299396476},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\services\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"filename\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\\\\src\\\\services\\\\apiKey.service.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Học hành tử tế\\\\Facebook\\\\backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.7:development":{"value":{"code":"\"use strict\";\n\nconst {\n  v4: uuidv4\n} = require(\"uuid\");\nconst apiKey = require(\"../models/apikey.model\");\nconst crypto = require(\"crypto\");\nconst findById = async key => {\n  try {\n    console.log(\"getkey\");\n    const newKey = await apiKey.create({\n      key: crypto.randomBytes(64).toString(\"hex\"),\n      status: true,\n      permission: \"0000\"\n    });\n    return newKey;\n  } catch (error) {\n    console.error(\"Error creating API key:\", error);\n    throw error;\n  }\n};\nmodule.exports = {\n  findById\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2NCIsInV1aWR2NCIsInJlcXVpcmUiLCJhcGlLZXkiLCJjcnlwdG8iLCJmaW5kQnlJZCIsImtleSIsImNvbnNvbGUiLCJsb2ciLCJuZXdLZXkiLCJjcmVhdGUiLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwic3RhdHVzIiwicGVybWlzc2lvbiIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXEjhu41jIGjDoG5oIHThu60gdOG6v1xcRmFjZWJvb2tcXGJhY2tlbmRcXHNyY1xcc2VydmljZXNcXCIsInNvdXJjZXMiOlsiYXBpS2V5LnNlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbmNvbnN0IHsgdjQ6IHV1aWR2NCB9ID0gcmVxdWlyZShcInV1aWRcIik7XHJcblxyXG5jb25zdCBhcGlLZXkgPSByZXF1aXJlKFwiLi4vbW9kZWxzL2FwaWtleS5tb2RlbFwiKTtcclxuY29uc3QgY3J5cHRvID0gcmVxdWlyZShcImNyeXB0b1wiKTtcclxuXHJcbmNvbnN0IGZpbmRCeUlkID0gYXN5bmMgKGtleSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhcImdldGtleVwiKTtcclxuICAgIGNvbnN0IG5ld0tleSA9IGF3YWl0IGFwaUtleS5jcmVhdGUoe1xyXG4gICAgICBrZXk6IGNyeXB0by5yYW5kb21CeXRlcyg2NCkudG9TdHJpbmcoXCJoZXhcIiksXHJcbiAgICAgIHN0YXR1czogdHJ1ZSxcclxuICAgICAgcGVybWlzc2lvbjogXCIwMDAwXCIsXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBuZXdLZXk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBBUEkga2V5OlwiLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBmaW5kQnlJZCxcclxufTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUNaLE1BQU07RUFBRUEsRUFBRSxFQUFFQztBQUFPLENBQUMsR0FBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUV0QyxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQztBQUNoRCxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFaEMsTUFBTUcsUUFBUSxHQUFHLE1BQU9DLEdBQUcsSUFBSztFQUM5QixJQUFJO0lBQ0ZDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFFBQVEsQ0FBQztJQUNyQixNQUFNQyxNQUFNLEdBQUcsTUFBTU4sTUFBTSxDQUFDTyxNQUFNLENBQUM7TUFDakNKLEdBQUcsRUFBRUYsTUFBTSxDQUFDTyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUNDLFFBQVEsQ0FBQyxLQUFLLENBQUM7TUFDM0NDLE1BQU0sRUFBRSxJQUFJO01BQ1pDLFVBQVUsRUFBRTtJQUNkLENBQUMsQ0FBQztJQUNGLE9BQU9MLE1BQU07RUFDZixDQUFDLENBQUMsT0FBT00sS0FBSyxFQUFFO0lBQ2RSLE9BQU8sQ0FBQ1EsS0FBSyxDQUFDLHlCQUF5QixFQUFFQSxLQUFLLENBQUM7SUFDL0MsTUFBTUEsS0FBSztFQUNiO0FBQ0YsQ0FBQztBQUVEQyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUNmWjtBQUNGLENBQUMifQ==","map":{"version":3,"names":["v4","uuidv4","require","apiKey","crypto","findById","key","console","log","newKey","create","randomBytes","toString","status","permission","error","module","exports"],"sourceRoot":"D:\\Học hành tử tế\\Facebook\\backend\\src\\services\\","sources":["apiKey.service.js"],"sourcesContent":["\"use strict\";\r\nconst { v4: uuidv4 } = require(\"uuid\");\r\n\r\nconst apiKey = require(\"../models/apikey.model\");\r\nconst crypto = require(\"crypto\");\r\n\r\nconst findById = async (key) => {\r\n  try {\r\n    console.log(\"getkey\");\r\n    const newKey = await apiKey.create({\r\n      key: crypto.randomBytes(64).toString(\"hex\"),\r\n      status: true,\r\n      permission: \"0000\",\r\n    });\r\n    return newKey;\r\n  } catch (error) {\r\n    console.error(\"Error creating API key:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  findById,\r\n};\r\n"],"mappings":"AAAA,YAAY;;AACZ,MAAM;EAAEA,EAAE,EAAEC;AAAO,CAAC,GAAGC,OAAO,CAAC,MAAM,CAAC;AAEtC,MAAMC,MAAM,GAAGD,OAAO,CAAC,wBAAwB,CAAC;AAChD,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAEhC,MAAMG,QAAQ,GAAG,MAAOC,GAAG,IAAK;EAC9B,IAAI;IACFC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IACrB,MAAMC,MAAM,GAAG,MAAMN,MAAM,CAACO,MAAM,CAAC;MACjCJ,GAAG,EAAEF,MAAM,CAACO,WAAW,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC;MAC3CC,MAAM,EAAE,IAAI;MACZC,UAAU,EAAE;IACd,CAAC,CAAC;IACF,OAAOL,MAAM;EACf,CAAC,CAAC,OAAOM,KAAK,EAAE;IACdR,OAAO,CAACQ,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/C,MAAMA,KAAK;EACb;AACF,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG;EACfZ;AACF,CAAC"}},"mtime":1714278080557}}